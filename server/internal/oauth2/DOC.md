<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# oauth2

```go
import "github.com/Epitech-2nd-Year-Projects/AREA/server/internal/oauth2"
```

## Index

- [func DeriveCodeChallenge\(verifier string, method CodeChallengeMethod\) \(string, error\)](<#DeriveCodeChallenge>)
- [func GenerateCodeVerifier\(length int\) \(string, error\)](<#GenerateCodeVerifier>)
- [func GenerateState\(size int\) \(string, error\)](<#GenerateState>)
- [type AuthorizationRequest](<#AuthorizationRequest>)
- [type AuthorizationResult](<#AuthorizationResult>)
- [type Client](<#Client>)
  - [func NewClient\(cfg Config, opts ...Option\) \(\*Client, error\)](<#NewClient>)
  - [func \(c \*Client\) AuthorizationURL\(ctx context.Context, req AuthorizationRequest\) \(AuthorizationResult, error\)](<#Client.AuthorizationURL>)
  - [func \(c \*Client\) Exchange\(ctx context.Context, req ExchangeRequest\) \(Token, error\)](<#Client.Exchange>)
  - [func \(c \*Client\) Refresh\(ctx context.Context, req RefreshRequest\) \(Token, error\)](<#Client.Refresh>)
- [type Clock](<#Clock>)
- [type CodeChallengeMethod](<#CodeChallengeMethod>)
  - [func GeneratePKCE\(\) \(verifier string, challenge string, method CodeChallengeMethod, err error\)](<#GeneratePKCE>)
  - [func \(m CodeChallengeMethod\) Valid\(\) bool](<#CodeChallengeMethod.Valid>)
- [type Config](<#Config>)
- [type ExchangeRequest](<#ExchangeRequest>)
- [type HTTPClient](<#HTTPClient>)
- [type Option](<#Option>)
  - [func WithClock\(clock Clock\) Option](<#WithClock>)
  - [func WithHTTPClient\(client HTTPClient\) Option](<#WithHTTPClient>)
  - [func WithStateSize\(size int\) Option](<#WithStateSize>)
  - [func WithVerifierLength\(length int\) Option](<#WithVerifierLength>)
- [type RefreshRequest](<#RefreshRequest>)
- [type Token](<#Token>)
  - [func \(t Token\) Expired\(now time.Time, skew time.Duration\) bool](<#Token.Expired>)
  - [func \(t Token\) HasRefreshToken\(\) bool](<#Token.HasRefreshToken>)


<a name="DeriveCodeChallenge"></a>
## func [DeriveCodeChallenge](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/pkce.go#L10>)

```go
func DeriveCodeChallenge(verifier string, method CodeChallengeMethod) (string, error)
```

DeriveCodeChallenge computes a PKCE code challenge from the provided verifier

<a name="GenerateCodeVerifier"></a>
## func [GenerateCodeVerifier](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/random.go#L29>)

```go
func GenerateCodeVerifier(length int) (string, error)
```

GenerateCodeVerifier produces a PKCE code verifier of the requested length

<a name="GenerateState"></a>
## func [GenerateState](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/random.go#L17>)

```go
func GenerateState(size int) (string, error)
```

GenerateState returns a cryptographically secure state parameter suitable for OAuth flows

<a name="AuthorizationRequest"></a>
## type [AuthorizationRequest](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L37-L46>)

AuthorizationRequest configures the authorization redirect Extra parameters are appended to the query string as\-is

```go
type AuthorizationRequest struct {
    RedirectURI         string
    Scopes              []string
    State               string
    Prompt              string
    PKCE                bool
    CodeVerifier        string
    CodeChallengeMethod CodeChallengeMethod
    Extra               map[string]string
}
```

<a name="AuthorizationResult"></a>
## type [AuthorizationResult](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L50-L56>)

AuthorizationResult captures the redirect data for a user agent CodeVerifier and CodeChallenge are empty when PKCE is disabled

```go
type AuthorizationResult struct {
    URL                 string
    State               string
    CodeVerifier        string
    CodeChallenge       string
    CodeChallengeMethod CodeChallengeMethod
}
```

<a name="Client"></a>
## type [Client](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L88-L94>)

Client implements core OAuth2 flows without external dependencies

```go
type Client struct {
    // contains filtered or unexported fields
}
```

<a name="NewClient"></a>
### func [NewClient](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L138>)

```go
func NewClient(cfg Config, opts ...Option) (*Client, error)
```

NewClient constructs an OAuth2 client from configuration and options

<a name="Client.AuthorizationURL"></a>
### func \(\*Client\) [AuthorizationURL](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L167>)

```go
func (c *Client) AuthorizationURL(ctx context.Context, req AuthorizationRequest) (AuthorizationResult, error)
```

AuthorizationURL builds the URL to redirect a user to the OAuth provider

<a name="Client.Exchange"></a>
### func \(\*Client\) [Exchange](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L266>)

```go
func (c *Client) Exchange(ctx context.Context, req ExchangeRequest) (Token, error)
```

Exchange swaps an authorization code for access credentials

<a name="Client.Refresh"></a>
### func \(\*Client\) [Refresh](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L302>)

```go
func (c *Client) Refresh(ctx context.Context, req RefreshRequest) (Token, error)
```

Refresh requests a new access token using a refresh token

<a name="Clock"></a>
## type [Clock](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L79-L81>)

Clock provides the current time to support testing

```go
type Clock interface {
    Now() time.Time
}
```

<a name="CodeChallengeMethod"></a>
## type [CodeChallengeMethod](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/types.go#L4>)

CodeChallengeMethod enumerates the supported PKCE challenge strategies

```go
type CodeChallengeMethod string
```

<a name="CodeChallengeMethodPlain"></a>

```go
const (
    // CodeChallengeMethodPlain represents the RFC7636 plain method
    CodeChallengeMethodPlain CodeChallengeMethod = "plain"
    // CodeChallengeMethodS256 represents the RFC7636 S256 method
    CodeChallengeMethodS256 CodeChallengeMethod = "S256"
)
```

<a name="GeneratePKCE"></a>
### func [GeneratePKCE](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/pkce.go#L30>)

```go
func GeneratePKCE() (verifier string, challenge string, method CodeChallengeMethod, err error)
```

GeneratePKCE returns a verifier, challenge, and method using the recommended settings

<a name="CodeChallengeMethod.Valid"></a>
### func \(CodeChallengeMethod\) [Valid](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/types.go#L14>)

```go
func (m CodeChallengeMethod) Valid() bool
```

Valid reports whether the code challenge method is supported

<a name="Config"></a>
## type [Config](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L20-L33>)

Config describes an OAuth2 provider endpoints and credentials TokenURL must accept application/x\-www\-form\-urlencoded requests AuthURL is the authorization endpoint used to initiate the code flow

```go
type Config struct {
    Name            string
    ClientID        string
    ClientSecret    string
    AuthURL         string
    TokenURL        string
    UserInfoURL     string
    Scopes          []string
    Prompt          string
    Audience        string
    TokenAuthMethod string
    TokenFormat     string
    TokenHeaders    map[string]string
}
```

<a name="ExchangeRequest"></a>
## type [ExchangeRequest](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L59-L64>)

ExchangeRequest wraps contextual parameters for token exchanges

```go
type ExchangeRequest struct {
    Code         string
    RedirectURI  string
    CodeVerifier string
    Extra        map[string]string
}
```

<a name="HTTPClient"></a>
## type [HTTPClient](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L74-L76>)

HTTPClient is the subset of http.Client used by the OAuth client

```go
type HTTPClient interface {
    Do(req *http.Request) (*http.Response, error)
}
```

<a name="Option"></a>
## type [Option](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L99>)

Option customizes the OAuth client construction Options are applied in order They should be idempotent to simplify reuse

```go
type Option func(*Client)
```

<a name="WithClock"></a>
### func [WithClock](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L111>)

```go
func WithClock(clock Clock) Option
```

WithClock injects a custom time source

<a name="WithHTTPClient"></a>
### func [WithHTTPClient](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L102>)

```go
func WithHTTPClient(client HTTPClient) Option
```

WithHTTPClient overrides the default http.Client

<a name="WithStateSize"></a>
### func [WithStateSize](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L120>)

```go
func WithStateSize(size int) Option
```

WithStateSize updates the random state length used when generating new values

<a name="WithVerifierLength"></a>
### func [WithVerifierLength](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L129>)

```go
func WithVerifierLength(length int) Option
```

WithVerifierLength overrides the generated PKCE verifier size

<a name="RefreshRequest"></a>
## type [RefreshRequest](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/client.go#L67-L71>)

RefreshRequest carries inputs required to refresh an access token

```go
type RefreshRequest struct {
    RefreshToken string
    Scopes       []string
    Extra        map[string]string
}
```

<a name="Token"></a>
## type [Token](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/token.go#L6-L14>)

Token represents OAuth2 credentials issued by a provider

```go
type Token struct {
    AccessToken  string
    RefreshToken string
    TokenType    string
    ExpiresAt    time.Time
    Scope        []string
    IDToken      string
    Raw          map[string]any
}
```

<a name="Token.Expired"></a>
### func \(Token\) [Expired](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/token.go#L17>)

```go
func (t Token) Expired(now time.Time, skew time.Duration) bool
```

Expired reports whether the token lifetime has elapsed accounting for skew

<a name="Token.HasRefreshToken"></a>
### func \(Token\) [HasRefreshToken](<https://github.com/Epitech-2nd-Year-Projects/AREA/blob/main/server/internal/oauth2/token.go#L30>)

```go
func (t Token) HasRefreshToken() bool
```

HasRefreshToken signals whether the token includes a refresh token

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
